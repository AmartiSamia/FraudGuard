@startuml FraudGuard_Sequence
title FraudGuard - Transaction Processing Flow

skinparam backgroundColor #0F0F0F
skinparam defaultFontColor #FFFFFF
skinparam sequenceActorBackgroundColor #0D47A1
skinparam sequenceParticipantBackgroundColor #1A3A52
skinparam sequenceArrowColor #2E90E6
skinparam sequenceGroupBackgroundColor #162542

actor Customer
participant Angular
participant API
participant Redis
participant DB
participant Kafka
participant ML
participant Prometheus
participant Grafana

autonumber 1

== Login & Auth ==
Customer -> Angular: Open app
Angular -> API: GET /login
API -> Redis: Check cache
alt Cache hit
    Redis --> API: User data
else Cache miss
    API -> DB: SELECT users
    DB --> API: User data
end
API --> Angular: Token
Angular --> Customer: Success

== Submit Transaction ==
Customer -> Angular: Submit TX
Angular -> API: POST /transactions

== Validate & Enrich ==
API -> Redis: GET history
API -> DB: SELECT recent

== Save TX ==
API -> DB: INSERT transaction
DB --> API: TX ID

== Publish to Kafka ==
API -> Kafka: PUBLISH TX

== ML Analysis ==
Kafka --> ML: SUBSCRIBE
ML -> ML: Extract 20+ features
ML -> ML: XGBoost predict
note over ML: Accuracy: 98%\nTime: <50ms
ML --> Kafka: PUBLISH result

== Save Alert ==
Kafka --> API: SUBSCRIBE
API -> DB: INSERT alert
API -> Redis: Cache result

== Publish Audit ==
API -> Kafka: PUBLISH audit

== Response ==
API --> Angular: Approved âœ…
Angular --> Customer: Success

== Metrics ==
API -.-> Prometheus: Metrics
ML -.-> Prometheus
DB -.-> Prometheus
Redis -.-> Prometheus
Kafka -.-> Prometheus
Prometheus --> Grafana: Data
Grafana -> Grafana: Update charts

@enduml
