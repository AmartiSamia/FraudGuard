<div class="page-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Transactions Suspectes</h1>
      <p class="page-description">Examinez les transactions signalées pouvant indiquer une activité frauduleuse</p>
    </div>
    <button class="btn btn-secondary" (click)="refresh()">
      <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"/>
      </svg>
      Actualiser
    </button>
  </div>

  <!-- Stats Summary -->
  <div *ngIf="!loading" class="stats-summary">
    <div class="stat-item danger">
      <span class="stat-number">{{ suspiciousTransactions.length }}</span>
      <span class="stat-label">Transactions Suspectes</span>
    </div>
    <div class="stat-item warning">
      <span class="stat-number">{{ getTotalAmount() | number:'1.0-0' }}</span>
      <span class="stat-label">Montant Total (MAD)</span>
    </div>
    <div class="stat-item info">
      <span class="stat-number">{{ getUniqueCountries() }}</span>
      <span class="stat-label">Pays Concernés</span>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="alert alert-danger">
    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
    </svg>
    {{ error }}
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-overlay">
    <div class="spinner"></div>
    <p>Chargement des transactions suspectes...</p>
  </div>

  <!-- Content -->
  <div *ngIf="!loading" class="content-card">
    <div class="card-header">
      <h3>
        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" class="header-icon">
          <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
        </svg>
        Transactions Signalées
      </h3>
      <span class="record-count">{{ suspiciousTransactions.length }} enregistrements</span>
    </div>

    <div class="table-container">
      <table class="data-table" *ngIf="suspiciousTransactions.length > 0">
        <thead>
          <tr>
            <th>ID</th>
            <th>Propriétaire</th>
            <th>Montant</th>
            <th>Type</th>
            <th>Pays</th>
            <th>Appareil</th>
            <th>Date</th>
            <th>Raison Fraude</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let transaction of suspiciousTransactions">
            <td class="id-cell">#{{ transaction.id }}</td>
            <td>{{ transaction.accountOwner }}</td>
            <td class="amount-cell">{{ transaction.amount | number:'1.2-2' }} MAD</td>
            <td><span class="badge" [class.badge-info]="transaction.type === 'Credit'" [class.badge-warning]="transaction.type === 'Debit'">{{ transaction.type }}</span></td>
            <td>{{ transaction.country }}</td>
            <td>{{ transaction.device }}</td>
            <td>{{ transaction.timestamp | date: 'dd/MM/yyyy HH:mm' }}</td>
            <td>
              <span *ngIf="transaction.fraudReason" class="badge badge-danger">{{ transaction.fraudReason }}</span>
              <span *ngIf="!transaction.fraudReason" class="badge badge-warning">ML Détection</span>
            </td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="suspiciousTransactions.length === 0" class="empty-state">
        <div class="empty-icon">
          <svg width="48" height="48" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
          </svg>
        </div>
        <h4>Tout est en ordre !</h4>
        <p>Aucune transaction suspecte détectée</p>
      </div>
    </div>
  </div>
</div>
